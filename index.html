<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kew Garden Flowers · Order Manager</title>

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#e0724c" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="KGF Orders" />
    <link rel="manifest" href="manifest.json" />
    <link rel="apple-touch-icon" href="icons/icon-192.png" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;600&family=Work+Sans:wght@300;400;500;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header class="app-header">
      <div class="brand">
        <span class="brand-mark">K</span>
        <div>
          <p class="brand-name">Kew Garden Flowers</p>
          <p class="brand-tagline">Order Manager</p>
        </div>
      </div>
      <div style="display: flex; gap: 0.5rem; align-items: center">
        <a href="settings.html" class="ghost-button" aria-label="Settings"
          >⚙️</a
        >
        <button id="signOut" class="ghost-button" aria-label="Sign out">
          Sign out
        </button>
      </div>
    </header>

    <main>
      <section class="hero">
        <h1>Good day, Bay!</h1>
        <p>
          Track client details, manage bouquet orders, and stay on top of
          delivery commitments. Built for fast updates from your phone.
        </p>
        <div class="hero-actions">
          <button id="addOrderButton" class="primary-button">
            + Add manual order
          </button>
          <a id="clientLinkButton" class="ghost-button" href="order.html">
            Copy client order link
          </a>
        </div>
      </section>

      <nav class="tab-nav" aria-label="Dashboard sections">
        <button class="tab-button active" data-target="orders">Orders</button>
        <button class="tab-button" data-target="clients">Clients</button>
        <button class="tab-button" data-target="invoices">Invoices</button>
        <button class="tab-button" data-target="calendar">Calendar</button>
      </nav>

      <section id="orders" class="tab-panel active" aria-labelledby="Orders">
        <div class="panel-header">
          <h2>Orders</h2>
          <label class="filter">
            <span>Status</span>
            <select id="statusFilter">
              <option value="all">All</option>
              <option value="pending">Unfulfilled</option>
              <option value="fulfilled">Fulfilled</option>
            </select>
          </label>
        </div>
        <div id="ordersList" class="card-list" role="list"></div>
        <p class="empty-state" data-for="orders">
          No orders yet. Tap “Add manual order” to get started.
        </p>
      </section>

      <section id="clients" class="tab-panel" aria-labelledby="Clients">
        <div class="panel-header">
          <h2>Clients</h2>
          <div class="client-sort-controls">
            <label class="filter">
              <span>Sort by</span>
              <select id="clientSortBy">
                <option value="name">Name (A-Z)</option>
                <option value="orders">Order Count</option>
                <option value="total">Total Spent</option>
                <option value="recent">Recent Activity</option>
              </select>
            </label>
            <input
              type="search"
              id="clientSearch"
              placeholder="Search clients..."
              style="
                padding: 0.4rem 0.75rem;
                border-radius: 999px;
                border: 1px solid var(--border);
                font: inherit;
                min-width: 200px;
              "
            />
          </div>
        </div>
        <div id="clientStats" class="client-stats" style="display: none">
          <div class="client-stat">
            <span class="client-stat-label">Total Clients</span>
            <span class="client-stat-value" id="totalClients">0</span>
          </div>
          <div class="client-stat">
            <span class="client-stat-label">Total Revenue</span>
            <span class="client-stat-value" id="totalRevenue">HKD 0</span>
          </div>
        </div>
        <div id="clientsList" class="card-list" role="list"></div>
        <p class="empty-state" data-for="clients">
          Client profiles will appear here once orders are saved.
        </p>
      </section>

      <section id="invoices" class="tab-panel" aria-labelledby="Invoices">
        <div class="panel-header">
          <h2>Invoices</h2>
          <div
            style="
              display: flex;
              gap: 0.75rem;
              align-items: center;
              flex-wrap: wrap;
            "
          >
            <button id="createInvoiceButton" class="primary-button">
              + Create invoice
            </button>
            <label class="filter">
              <span>Status</span>
              <select id="invoiceStatusFilter">
                <option value="all">All</option>
                <option value="draft">Draft</option>
                <option value="sent">Sent</option>
                <option value="paid">Paid</option>
              </select>
            </label>
          </div>
        </div>
        <div id="invoicesList" class="card-list" role="list"></div>
        <p class="empty-state" data-for="invoices">
          No invoices yet. Create your first invoice to get started.
        </p>
      </section>

      <section id="calendar" class="tab-panel" aria-labelledby="Calendar">
        <div class="panel-header">
          <h2>Delivery schedule</h2>
          <div
            class="filter"
            style="display: flex; gap: 0.75rem; align-items: center"
          >
            <label class="filter">
              <span>View</span>
              <select id="calendarView">
                <option value="agenda">Agenda</option>
                <option value="month">Month</option>
              </select>
            </label>
            <label
              class="filter"
              style="display: inline-flex; gap: 0.5rem; align-items: center"
            >
              <input id="hideFulfilled" type="checkbox" />
              <span>Hide fulfilled</span>
            </label>
          </div>
        </div>
        <ol id="calendarList" class="calendar-list"></ol>
        <p class="empty-state" data-for="calendar">
          Add delivery dates to see them in your schedule.
        </p>
      </section>
    </main>

    <div
      id="orderDialog"
      class="modal"
      role="dialog"
      aria-modal="true"
      aria-labelledby="orderFormTitle"
      hidden
    >
      <div class="modal-overlay" data-close-dialog></div>
      <div class="modal-content">
        <form id="orderForm">
          <header>
            <h2 id="orderFormTitle">New order</h2>
            <button
              type="button"
              class="ghost-button"
              id="closeDialog"
              aria-label="Close"
            >
              ✕
            </button>
          </header>
          <section class="form-grid">
            <div class="input-group">
              <label for="clientName">Client name</label>
              <input id="clientName" name="clientName" type="text" required />
            </div>
            <div class="input-group">
              <label for="clientPhone">Phone number</label>
              <input id="clientPhone" name="clientPhone" type="tel" required />
            </div>
            <div class="input-group">
              <label for="clientEmail">Email (optional)</label>
              <input id="clientEmail" name="clientEmail" type="email" />
            </div>
            <div class="input-group">
              <label for="deliveryDate">Delivery date</label>
              <input
                id="deliveryDate"
                name="deliveryDate"
                type="date"
                required
              />
            </div>
            <div class="input-group">
              <label for="bouquetType">Bouquet type</label>
              <select id="bouquetType" name="bouquetType" required>
                <option value="Peony Sunrise">Peony Sunrise</option>
                <option value="Lavender Mist">Lavender Mist</option>
                <option value="Autumn Ember">Autumn Ember</option>
                <option value="Emerald Cascade">Emerald Cascade</option>
                <option value="Rose Quartz">Rose Quartz</option>
              </select>
            </div>
            <div class="input-group">
              <label for="priceHkd">Price (HKD)</label>
              <input
                id="priceHkd"
                name="priceHkd"
                type="text"
                inputmode="decimal"
                placeholder="$1500.00"
                required
              />
            </div>
            <div class="input-group">
              <label for="deliveryTimeSlot">Delivery time</label>
              <select id="deliveryTimeSlot" name="deliveryTimeSlot" required>
                <option value="10am-12pm">10am – 12pm</option>
                <option value="1pm-3pm">1pm – 3pm</option>
                <option value="3pm-5pm">3pm – 5pm</option>
                <option value="self-pickup">Self pickup</option>
              </select>
            </div>
            <div class="input-group span-2">
              <label for="cardMessage">Message on card</label>
              <textarea
                id="cardMessage"
                name="cardMessage"
                rows="3"
                required
              ></textarea>
            </div>
            <div class="input-group span-2">
              <label for="deliveryAddress">Delivery address</label>
              <textarea
                id="deliveryAddress"
                name="deliveryAddress"
                rows="2"
                placeholder="Recipient name, venue, delivery window"
                required
              ></textarea>
            </div>
            <div class="input-group">
              <label for="orderStatus">Status</label>
              <select id="orderStatus" name="orderStatus">
                <option value="pending">Unfulfilled</option>
                <option value="fulfilled">Fulfilled</option>
              </select>
            </div>
            <div class="input-group">
              <label for="notes">Internal notes</label>
              <textarea id="notes" name="notes" rows="2"></textarea>
            </div>
          </section>
          <footer>
            <button class="ghost-button" type="button" id="deleteOrder">
              Delete
            </button>
            <button class="primary-button" type="submit">Save order</button>
          </footer>
        </form>
      </div>
    </div>

    <div class="toast" role="status" aria-live="polite" hidden></div>

    <template id="orderCardTemplate">
      <article class="card" role="listitem">
        <header>
          <h3 class="card-title"></h3>
          <span class="status-pill" title="Tap to toggle status"></span>
        </header>
        <p class="card-detail delivery-date"></p>
        <p class="card-detail"></p>
        <p class="card-detail"></p>
        <footer>
          <button class="ghost-button">Open</button>
        </footer>
      </article>
    </template>

    <template id="clientCardTemplate">
      <article class="card" role="listitem">
        <header>
          <h3 class="card-title"></h3>
        </header>
        <p class="card-detail"></p>
        <p class="card-detail"></p>
        <footer>
          <span class="order-count"></span>
        </footer>
      </article>
    </template>

    <template id="invoiceCardTemplate">
      <article class="card" role="listitem">
        <header>
          <h3 class="card-title"></h3>
          <span class="status-pill"></span>
        </header>
        <p class="card-detail"></p>
        <p class="card-detail"></p>
        <footer
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
          "
        >
          <span class="invoice-amount"></span>
          <div style="display: flex; gap: 0.5rem">
            <button class="ghost-button btn-view">View</button>
            <button class="ghost-button btn-download">PDF</button>
          </div>
        </footer>
      </article>
    </template>

    <div
      id="invoiceDialog"
      class="modal"
      role="dialog"
      aria-modal="true"
      aria-labelledby="invoiceFormTitle"
      hidden
    >
      <div class="modal-overlay" data-close-invoice-dialog></div>
      <div class="modal-content" style="max-width: 720px">
        <form id="invoiceForm">
          <header>
            <h2 id="invoiceFormTitle">Create invoice</h2>
            <button
              type="button"
              class="ghost-button"
              id="closeInvoiceDialog"
              aria-label="Close"
            >
              ✕
            </button>
          </header>
          <section class="form-grid">
            <div class="input-group">
              <label for="invoiceClient">Client</label>
              <select id="invoiceClient" name="invoiceClient" required>
                <option value="">Select client...</option>
              </select>
            </div>
            <div class="input-group">
              <label for="invoiceNumber">Invoice number</label>
              <input
                id="invoiceNumber"
                name="invoiceNumber"
                type="text"
                required
                readonly
              />
            </div>
            <div class="input-group">
              <label for="invoiceDate">Invoice date</label>
              <input id="invoiceDate" name="invoiceDate" type="date" required />
            </div>
            <div class="input-group">
              <label for="invoiceDueDate">Due date</label>
              <input id="invoiceDueDate" name="invoiceDueDate" type="date" />
            </div>
            <div class="input-group span-2">
              <label>Select orders to include</label>
              <div
                id="invoiceOrdersList"
                style="
                  max-height: 200px;
                  overflow-y: auto;
                  border: 1px solid rgba(47, 44, 40, 0.1);
                  border-radius: 12px;
                  padding: 0.75rem;
                "
              >
                <p style="color: var(--text-muted); font-size: 0.9rem">
                  Select a client to see their orders
                </p>
              </div>
            </div>
            <div class="input-group span-2">
              <label for="invoiceNotes">Notes (optional)</label>
              <textarea
                id="invoiceNotes"
                name="invoiceNotes"
                rows="2"
              ></textarea>
            </div>
            <div class="input-group">
              <label>Subtotal</label>
              <input id="invoiceSubtotal" type="text" readonly value="$0.00" />
            </div>
            <div class="input-group">
              <label>Total</label>
              <input
                id="invoiceTotal"
                type="text"
                readonly
                value="$0.00"
                style="font-weight: 600"
              />
            </div>
          </section>
          <footer>
            <button class="ghost-button" type="button" id="deleteInvoice">
              Delete
            </button>
            <button class="primary-button" type="submit">Save invoice</button>
          </footer>
        </form>
      </div>
    </div>

    <script type="module" src="js/config.js"></script>
    <script type="module" src="js/app.js"></script>
    <script type="module" src="js/pwa.js"></script>
  </body>
</html>
